syntax = "proto3";

package com.cognite.seismic.v1;

import "cognite/seismic/protos/types.proto";
import "cognite/seismic/protos/v1/seismic_service_datatypes.proto";
import "cognite/seismic/protos/v1/seismic_service_messages.proto";

/**
Service for querying data and metadata from seismic tracestore in Cognite Data Fusion (CDF) seismic datastore.

Queries are done primarily on cubes, with some management endpoints for tracestores & partitions. 

Queries are divided in:
    Metadata: General information and headers for surveys and files
    Trace: Retrieve traces, be it by geometry, line or volume
    Artificial sampling: Get the (calculated/interpolated) values of properties in the file/tracestore given arbitrary positions
**/

service Seismic {
// Metadata queries

    /**
    Get Survey by ID.
    REMOVED: Use SearchSurveys, providing SearchSpec with the survey ID.
    rpc GetSurvey (SurveyQueryRequest) returns (GetSurveyResponse) {}
    **/

    /**
    Lists all surveys accessible to the client. Optionally includes Cubes associated with the surveys.
    
    Can optionally search surveys based on both/either of two criteria:
        Coverage polygon of files in the survey are within an area delimited by a specified polygon
        Filters on metadata of both the survey and the file
    **/
    rpc SearchSurveys (SearchSurveysRequest) returns (stream SearchSurveyResponse) {}

    /**
    REMOVED: Use ReadSurveys with SearchSpec
    rpc SearchSurveys (SearchSurveyRequest) returns (SurveyWithFilesResponse) {}
    **/

    /**
    Create new Cubes and assign them to partitions.
    Excluding their name, Cubes are immutable. The user needs to delete an existing cutout and create a new one
    if e.g. the definition or the tracestore target must be changed
    **/
    rpc CreateCube (CreateCubeRequest) returns (Cube) {}

    /**
    Returns cube metadata given its id.
    Can optionally retrieve backing information & partition info if user has the right scope.
    Use GetVolume to retrieve traces.
    **/
    rpc SearchCubes (SearchCubesRequest) returns (stream Cube) {}

    /**
    Edit the specified cube. Although cube definitions can't be changed, their names can.
    If user wants to modify the definition or the owning partition, they should instead create a new partition and delete the old one.
    **/
    rpc EditCube (EditCubeRequest) returns (Cube) {}

    /**
    Delete cubes.
    **/
    rpc DeleteCubes (DeleteCubesRequest) returns (stream DeleteCubeResponse) {}

    /**
    Search and retrieve tracestores. Can only retrieve tracestores you own.
    **/
    rpc ReadTracestores (ReadTracestoreRequest) returns (stream Tracestore) {}

    /**
    Set the name of a tracestore.
    **/
    rpc SetTracestoreName (SetTracestoreNameRequest) returns (Tracestore) {}

    /**
    Returns a binary header given its file name or id.
    REMOVED: Use ReadCubes
    rpc GetBinaryHeader (HeaderFileQueryRequest) returns (GetBinaryHeaderResponse) {}
    **/

    /**
    Returns a text header given its file name or id.
    REMOVED: Use ReadCubes
    rpc GetTextHeader (HeaderFileQueryRequest) returns (GetTextHeaderResponse) {}
    **/

    /**
    Returns the coverage for a given file identified by its id or name.
    The coverage is represented by a polygon either in WKT or geojson and represents the area covered by traces
    in the file.
    There can be holes in the polygon if traces do not exist in an area inside of it.
    REMOVED: MOVING TO GEOSPATIAL
    rpc GetFileDataCoverage (FileCoverageRequest) returns (DataCoverageResponse) {}
    **/

    /**
    Returns the navigation polygon for the survey obtained from DISKOS
    REMOVED: WAS NOT IMPLEMENTED.
    rpc GetNavigationPolygon (NavigationPolygonRequest) returns (DataCoverageResponse) {}
    **/

    /**
    Returns the full range of the inlines and crosslines in the file, i.e. the minimum and maximum inline and crossline
    REMOVED: OPTIONALLY INCLUDE IN GetCutoutMetadata
    rpc GetFileLineRange (FileQueryRequest) returns (LineRangeResponse) {}
    **/

    /**
    Create partitions, possibly setting a name.
    **/
    rpc CreatePartitions (CreatePartitionsRequest) returns (stream Partition) {}

    /**
    Returns the partition(s) specified, with the same search options as the other search endpoints.
    **/
    rpc SearchPartitions (ReadPartitionsRequest) returns (stream Partition) {}

    /**
    Edit partitions. The only modifiable field is the name
    **/
    rpc EditPartition (EditPartitionRequest) returns (Partition) {}

    /**
    Delete the specified partitions, and return all partitions successfully deleted.
    **/
    rpc DeletePartitions (DeletePartitionsRequest) returns (stream DeletePartitionResponse) {} 

    /**
    Request a volume of traces by range of inlines, crosslines and time
    **/
    rpc GetVolume(VolumeRequest) returns (stream com.cognite.seismic.Trace) {}
}
